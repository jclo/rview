/*! ****************************************************************************
 * RView v1.0.4
 *
 * A companion Reactive View library for building web applications.
 * (you can download it from npm or github repositories)
 * Copyright (c) 2021 Mobilabs <contact@mobilabs.fr> (http://www.mobilabs.fr).
 * Released under the MIT license. You may obtain a copy of the License
 * at: http://www.opensource.org/licenses/mit-license.php).
 * Built from ES6Kadoo v1.0.5.
 * ************************************************************************** */
/*! Generated by Kadoo v1.0.3 */
!function(t,e){"use strict";"function"==typeof define&&define.amd?define([""],e):"object"==typeof exports?module.exports=e(t):t.RView=e(t)}(this,t=>{"use strict";let e={src:{rview:{},component:{main:{},hyperscript:{},diffing:{},config:{},generic:{},$:{},animate:{},add:{},render:{},setstate:{},util:{}},renderer:{main:{}},lib:{_:{}},plugin:{main:{}}},extend:function(t,e){for(var n=Object.keys(e),r=0;r<n.length;r++)t[n[r]]=e[n[r]]}};return function(){const n=e.src.component.main,r=e.src.renderer.main,{_:i}=e.src.lib,s=e.src.component.hyperscript,o=e.src.component.diffing,c=e.src.plugin.main,l=e.src.component.config,a=t.RView,d={_library:{name:"RView",version:"1.0.4"},_setTestMode:()=>[i,n.Component,s,o],noConflict(){return t.RView=a,this},whoami(){return this._library},h:(...t)=>s.format(...t),Component:t=>n.Component(t),render:t=>r.render(t),restore:t=>r.restore(t),remove:t=>r.remove(t),plugin:t=>c.plugin(t),makeid:()=>i.makeid(l.idLength),NAME:"RView",VERSION:"1.0.4"};e.src.rview=d}(),function(){const{_:t}=e.src.lib,n=e.src.component.generic,r=e.src.component.$;e.extend(e.src.component.main,{Component:function(e){let i;const s=function(){return this instanceof s?n.Construct.apply(this,i):(i=arguments,new s)},o=t.assign({},n.methods),c=t.assign(o,{$:r.$});return s.prototype=t.assign(c,e||{}),s.prototype.constructor=s,s}})}(),function(){const t=e.src.component.main,{_:n}=e.src.lib,r=e.src.plugin.main;function i(t){const e={el:"body",children:null,template:"<div></div>"};return t.el&&(!n.isString(t.el)||"#"!==t.el.charAt(0)&&"."!==t.el.charAt(0)?n.isObject(t.el)&&t.el.namespaceURI?e.el=t.el:t.silent||console.log("warning: el must be an id, a class or a node element!"):e.el=t.el),n.isString(t.template)?e.template=function(t){const e=document.createElement("div");if(e.innerHTML=t,e.children.length>1)return`<div>${t}</div>`;const n=e.firstElementChild;if(!n)return"<div></div>";const r=n.tagName.toLocaleLowerCase();return"div"!==r&&"header"!==r&&"footer"!==r?`<div>${t}</div>`:t}(t.template):t.silent||console.log("warning: template must be an XMLString starting with <div or <header or <footer!"),e.children=t.children,e}function s(t){const e=n.isString(t.el)?document.querySelector(t.el):t.el;"body"===t.el?e.innerHTML+=t.template:e.innerHTML=t.template}function o(e){const o=i(e),c=r.get("messenger");if(!e.children&&!e.template)return function(e,i){const{methods:s}=e||{},o=r.get("messenger");if("body"===i.el)return null;const c=n.isString(i.el)?document.querySelector(i.el):i.el,l=c.outerHTML,a=c.getAttribute("id"),d=c.className,u=c.getAttribute("style"),h=t.Component(n.extend(s,{init(){this.state.class=d||"",this.state.style=u||"",this.state.inside=""},render:t=>`\n            <div class="${t.class}" style="${t.style}">${t.inside}</div>\n          `}))(),p=h._renderer(),f=document.createElement("template");f.innerHTML=p;const m=f.content.firstChild;return c.parentNode.replaceChild(m,c),a&&(m.setAttribute("id",a),h.id=a),h._mess=o?o():null,h._initialXMLNode=l,h}(e,o);if(!o.children)return s(o),null;const l=t.Component({render(){return this.name="firstparent",this.children=o.children,o.template}})();return o.template=l._renderer(),s(o),l._mess=c?c():null,function t(e,n){if(e._cList){const r=Object.keys(e._cList);for(let i=0;i<r.length;i++)e._cList[r[i]]._mess=n,t(e._cList[r[i]],n)}}(l,l._mess),function t(e){if(e._cList){const n=Object.keys(e._cList);for(let r=0;r<n.length;r++)e._cList[n[r]].events(),t(e._cList[n[r]])}}(l),l}const c={render:t=>o(t),restore:t=>function(t){if(t&&t._initialXMLNode){const e=document.createElement("template");e.innerHTML=t._initialXMLNode;const n=e.content.firstChild;return t.$()[0].parentNode.replaceChild(n,t.$()[0]),!0}return!1}(t),remove(t){return(e=t).$().remove(),Object.keys(e).forEach(t=>{delete e[t]}),e.__proto__={},!0;var e}};e.extend(e.src.renderer.main,c)}(),function(){const t={extend(t,e){const n=Object.keys(e);for(let r=0;r<n.length;r++)t[n[r]]=e[n[r]];return t},assign(){const t=arguments[0];let e,n,r;for(r=1;r<arguments.length;r++)e=arguments[r],n=Object.keys(e).reduce((t,n)=>(t[n]=Object.getOwnPropertyDescriptor(e,n),t),{});return Object.defineProperties(t,n),t},isString:t=>"[object String]"===Object.prototype.toString.call(t),isNumber:t=>"[object Number]"===Object.prototype.toString.call(t),isObject(t){const e=typeof t;return("function"===e||"object"===e)&&!!t},isLiteralObject:t=>"[object Object]"===Object.prototype.toString.call(t),isFunction:t=>"[object Function]"===Object.prototype.toString.call(t),isArray:t=>"[object Array]"===Object.prototype.toString.call(t),makeid(t){const e=this.isNumber(t)?t:16,n="ABCDEFGHIJKLMNOPQRSTUVWXTZabcdefghijklmnopqrstuvwxyz",r="0123456789"+n;let i=n.charAt(Math.floor(Math.random()*n.length));for(let t=0;t<e-1;t++)i+=r.charAt(Math.floor(Math.random()*r.length));return i}};e.extend(e.src.lib._,t)}(),function(){const{_:t}=e.src.lib;function n(t){const e=Object.keys(t);let n="";for(let r=0;r<e.length;r++)n+=r<e.length-1?`${e[r]}: ${t[e[r]]}; `:`${e[r]}: ${t[e[r]]};`;return n}const r={format(...t){const[e,n,...r]=t;return{nodeName:e,attributes:n,children:r}},render(e,r){const i={};return function(t,e,n){const r=Object.keys(n);for(let i=0;i<r.length;i++)t=t.replace(`</${r[i].toLowerCase()}>`,"").replace(r[i].toLowerCase(),r[i]+" /"),e[`<${r[i]} />`]=n[r[i]];return t}((new XMLSerializer).serializeToString(function e(r,i){const{nodeName:s}=r,{attributes:o}=r,{children:c}=r;let l,a,d,u,h,p;if(t.isString(r))return document.createTextNode(r);switch(typeof s){case"string":for(l=document.createElement(s),a=o?Object.keys(o):[],p=0;p<a.length;p++)d=t.isObject(o[a[p]])?n(o[a[p]]):o[a[p]],l.setAttribute(a[p],d);break;case"function":u=s(),u.render?(h=o&&o.name?o.name:"C"+Math.random().toString(36).substr(2,7),i[h]={fn:s,state:o.state?o.state:null,props:o.props?o.props:null},l=e({nodeName:h,attributes:null,children:[]},i)):l=e(u,i);break;default:throw new Error(`hypserscript._render: nodeName is a ${typeof s} ???`)}for(p=0;p<c.length;p++)l.appendChild(e(c[p],i));return l}(e,i)).replace('xmlns="http://www.w3.org/1999/xhtml"',""),r,i)}};e.extend(e.src.component.hyperscript,r)}(),function(){const t=e.src.component.config;function n(t){return 3===t.nodeType?"text":8===t.nodeType?"comment":t.tagName.toLowerCase()}function r(t){return t.childNodes&&t.childNodes.length>0?null:t.textContent}function i(t,e){const n=t.getAttributeNames(),r=e.getAttributeNames();for(let r=0;r<n.length;r++){const i=n[r],s=e.attributes.getNamedItem(i),o=t.getAttribute(i),c=e.getAttribute(i);s&&c===o||e.setAttribute(i,o)}for(let t=0;t<r.length;t++)-1===n.indexOf(r[t])&&e.removeAttribute(r[t])}const s={stringToHTML:t=>function(t){return(new DOMParser).parseFromString(t,"text/html").body.firstChild}(t),diff(e,s){!function e(s,o){const c=Array.prototype.slice.call(s.childNodes),l=Array.prototype.slice.call(o.childNodes);let a=l.length-c.length;if(a>0)for(;a>0;a--)l[l.length-a].parentNode.removeChild(l[l.length-a]);c.forEach((s,c)=>{if("div"===n(s)&&s.hasAttribute("id")&&s.getAttribute("id").length===t.idLength&&l[c])return;if(!l[c])return void o.appendChild(s.cloneNode(!0));if(n(s)!==n(l[c]))return void l[c].parentNode.replaceChild(s.cloneNode(!0),l[c]);const a=r(s);a&&a!==r(l[c])&&(l[c].textContent=a);const d=n(s);if("text"!==d&&"comment"!==d&&(s.hasAttributes()||l[c].hasAttributes())&&i(s,l[c]),l[c].childNodes.length>0&&s.childNodes.length<1)l[c].innerHTML="";else{if(l[c].childNodes.length<1&&s.childNodes.length>0){const t=document.createDocumentFragment();return e(s,t),void l[c].appendChild(t)}s.childNodes.length>0&&e(s,l[c])}})}(e,s),i(e,s)}};e.extend(e.src.component.diffing,s)}(),function(){const{_:t}=e.src.lib;const n={_db:{messenger:null},plugin(e){return function(e,n){return!(!t.isLiteralObject(n)||!n.messenger||"Messenger"!==n.messenger.NAME)&&(e.messenger=n.messenger,!0)}(this._db,e)},get(e){return t.isString(e)&&this._db[e]?this._db[e]:null}};e.extend(e.src.plugin.main,n)}(),e.extend(e.src.component.config,{idLength:8}),function(){const{_:t}=e.src.lib,n=e.src.component.animate,r=e.src.component.add,i=e.src.component.render,s=e.src.component.hyperscript,o=e.src.component.setstate,c=e.src.component.util,l=e.src.component.config;const a={_init(...e){this._tag=null,this._cList=null,this._mess=null,this.id=t.makeid(l.idLength),this.children=null;const[n,r]=e;return this.state=t.isLiteralObject(n)?n:{},this.props=t.isLiteralObject(r)?r:{},this.name="mynameisnobody",this.init(),this},_renderer(){return i.render(this)},$:null,$animate(...t){return n.animate(this,...t),this},$append(...t){return r.append(this,...t),this},$getChild(t){return c.getChild(this,t)},$removeChild(t){return c.removeChild(this,t)},$getChildren(){return c.getChildren(this)},$getIdAndName(){return{id:this.id,name:this.name}},$hyperscript:(...t)=>s.format(...t),$setState(e){return t.isLiteralObject(e)&&o.setState(this,e),this},$listen(t,e){return this._mess?(this._mess.subscribe(t,e),this):(console.log("$listen: the plugin Messenger is not installed!"),this)},$emit(t,e){return this._mess?(this._mess.publish(t,e),this):(console.log("$emit: the plugin Messenger is not installed!"),this)},init(){return this},events(){return this},render:()=>"<div></div>"};e.extend(e.src.component.generic,{Construct:function(){this._init.apply(this,arguments)},methods:a})}(),e.extend(e.src.component.$,{$:function(t){const e=this.id;let n,r;return t?n=document.querySelector("#"+e).querySelector(t):(n=document.querySelector("#"+e),r=n),{0:n,id:n?n.id:null,_root:r,select:function(t){if("string"==typeof t&&this[0]){const e=this[0].querySelector(t);e&&(this[0]=e)}return this},selectChild:function(t){return"[object Number]"===Object.prototype.toString.call(t)&&(this[0]=this[0].children[t]?this[0].children[t]:this[0]),this},parent:function(){return this._root?this[0]!==this._root&&(this[0]=this[0].parentNode):this[0]=this[0].parentNode,this},firstParent:function(){return this._root&&(this[0]=this._root),this},find:function(t){return this[0].querySelectorAll(t)},tag:function(){return this[0]?this[0].tagName:null},innerHTML:function(){return this[0].innerHTML},outerHTML:function(){return this[0].outerHTML},text:function(){return this[0].textContent},firstChild:function(){return this[0].firstElementChild},children:function(){return this[0].children},childIndex:function(){let t=this[0],e=0;for(;null!==t;)t=t.previousElementSibling,e+=1;return e-1},getBoundingClientRect:function(){return this[0]?this[0].getBoundingClientRect():null},css:function(t){const e="string"==typeof t?t.split("-"):[];let n="";for(let t=0;t<e.length;t++)n+=0===t?e[t]:e[t].charAt(0).toUpperCase()+e[t].slice(1);return this[0].style[n]},getClassList:function(){return this[0].classList},hasClass:function(t){const e=this[0].classList.value.split(" ");return"[object String]"===Object.prototype.toString.call(t)&&-1!==e.indexOf(t)},attr:function(t){return this[0].getAttribute(t)},on:function(t,e){return this[0].addEventListener(t,e),this},off:function(t,e){return this[0].removeEventListener(t,e),this},trigger:function(t){return this[0].dispatchEvent(new Event(t))},remove:function(){return this[0].parentNode.removeChild(this[0]),this}}}}),function(){const{_:t}=e.src.lib;function n(t,e,n,r){return n*(.5-Math.cos(t/r*Math.PI)/2)+e}function r(t){return!("function"!=typeof t||"linear"!==t.name&&"swing"!==t.name&&!t.name.startsWith("easeIn")&&!t.name.startsWith("easeOut"))}function i(e,i,...s){if(!t.isLiteralObject(i))return;const o=function(...e){const n=e[0],i=e[1],s=e[2];let o,c,l,a;switch(o=n||i||s?!n||i||i?n&&i&&!s?2:3:1:0,o){case 0:break;case 1:t.isNumber(n)||"fast"===n||"slow"===n?c=n:t.isString(n)||r(n)?l=n:t.isFunction(n)&&(a=n);break;case 2:t.isNumber(n)||"fast"===n||"slow"===n?(c=n,t.isString(i)||r(i)?l=i:t.isFunction(i)&&(a=i)):(t.isString(n)||r(n))&&(l=n,t.isFunction(i)&&(a=i));break;case 3:(t.isNumber(n)||"fast"===n||"slow"===n)&&(c=n),(t.isString(i)||r(i))&&(l=i),t.isFunction(s)&&(a=s)}return{duration:c,easing:l,callback:a}}(...s),c=t.isNumber(o.duration)&&o.duration>0?o.duration:"fast"===(l=o.duration)?200:"slow"===l?600:400;var l;!function(e,n,r,i,s,o){const c=Object.keys(n),l=void 0!==n.$rpath?n.$rpath.split("."):[],a=c.indexOf("$rpath"),d={},u={};let h,p,f=0;a>-1&&c.splice(a,1);let m=e.state;l.forEach(t=>{m=m[t]}),c.forEach(e=>{h=parseFloat(m[e],10),d[e]={initial:parseFloat(m[e],10),change:parseFloat(n[e],10)-h,suffix:t.isString(n[e])?n[e].replace(/[0-9.]/g,""):""}});const g=setInterval(()=>{for(let t=0;t<c.length;t++)p=r(f,d[c[t]].initial,d[c[t]].change,i),u[c[t]]=p+d[c[t]].suffix;if(a>-1){Object.keys(u).forEach(t=>{m[t]=u[t]}),e.$setState({})}else e.$setState(u);f+=s,f>i&&(clearInterval(g),o&&o())},s)}(e,i,!o.easing||t.isString(o.easing)?n:o.easing,c,10,o.callback?o.callback:null)}const s={animate(t,e,...n){i(t,e,...n)}};e.extend(e.src.component.animate,s)}(),function(){const t=e.src.component.render;function n(e,n,...r){const[i,s,o]=r;!function(t,e,n,r,i,s){const o=r(i,s);o._tag=n,t._cList||(t._cList={}),t.children||(t.children={}),t._cList[o._tag.replace(/[^a-zA-z0-9]/g,"")]=o,t.children[n]={fn:r,state:i,props:s},e?(t._prepend||(t._prepend=[]),t._prepend.push(n)):(t._append||(t._append=[]),t._append.push(n))}(e,n,i,s,o.state,o.props);const c=e.$getChild(i);t.render(c),function t(e,n){if(n&&(e._mess=n,e._cList)){const r=Object.keys(e._cList);for(let i=0;i<r.length;i++)e._cList[r[i]]._mess=n,t(e._cList[r[i]],n)}}(c,e._mess),e.$setState({}),function t(e){if(e.events(),e._cList){const n=Object.keys(e._cList);for(let r=0;r<n.length;r++)e._cList[n[r]].events(),t(e._cList[n[r]])}}(c)}const r={prepend(t,...e){return n(t,!0,...e),this},append(t,...e){return n(t,!1,...e),this}};e.extend(e.src.component.add,r)}(),function(){const{_:t}=e.src.lib,n=e.src.component.hyperscript;function r(t,e){const n=document.createElement("div");if(n.innerHTML=t,n.children.length>1)return[`<div id="${e}">${t}</div>`,!0];const r=n.firstElementChild;if(!r)return[`<div id="${e}"></div>`,!0];const i=r.tagName.toLocaleLowerCase();return"div"!==i&&"header"!==i&&"footer"!==i?[`<div id="${e}">${t}</div>`,!0]:"div"===i?[t.replace(/^\s*<div/,`<div id="${e}"`),!1,"div"]:"header"===i?[t.replace(/^\s*<header/,`<header id="${e}"`),!1,"header"]:[t.replace(/^\s*<footer/,`<footer id="${e}"`),!1,"footer"]}function i(e){let i,s;i=e.render(e.state,e.props),t.isLiteralObject(i)&&t.isString(i.nodeName)&&(e.children={},i=n.render(i,e.children));const[o,c,l]=r(i,e.id);if(s=o,e._tdiv=c?"div":null,e._ttag=l||null,e.children){e.children=function(e){if(!t.isLiteralObject(e))return{};const n={},r=Object.keys(e);let i;for(let s=0;s<r.length;s++)i=r[s],t.isFunction(e[i])?n[i]={fn:e[i],state:null,props:null}:t.isLiteralObject(e[i])&&t.isFunction(e[i].fn)?n[i]={fn:e[i].fn,state:t.isLiteralObject(e[i].state)?e[i].state:null,props:t.isLiteralObject(e[i].props)?e[i].props:null}:(n[i]={fn:null,state:null,props:null},console.log('warning: this component list is invalid. key "c" is missing!'));return n}(e.children),e._cList={};const n=Object.keys(e.children);let r,i;for(let o=0;o<n.length;o++)r=n[o],t.isFunction(e.children[r].fn)?(i=e.children[r].fn(e.children[r].state,e.children[r].props),i._tag=r,s=s.replace(r,i._renderer()),e._cList[r.replace(/[^a-zA-z0-9]/g,"")]=i):console.log(`warning: there is no component associated to this tag: ${r}!`)}return s}function s(t,e){return`${(t=t.trim()).slice(0,t.indexOf(">")+1)}${e}${t.slice(t.indexOf(">")+1)}`}function o(t,e){return`${(t=t.trim()).slice(0,t.lastIndexOf("</"))}${e}${t.slice(t.lastIndexOf("</"))}`}function c(e){let i=e.render(e.state,e.props);if(t.isLiteralObject(i)&&t.isString(i.nodeName)&&(i=n.render(i,{})),[i]=r(i,e.id),t.isArray(e._prepend)){for(let t=0;t<e._prepend.length;t++)i=s(i,e._prepend[t]);return i}if(t.isArray(e._append)){for(let t=0;t<e._append.length;t++)i=o(i,e._append[t]);return i}return i}const l={render:t=>i(t),reRender:t=>function t(e,n){if(e._cList){const r=Object.keys(e._cList);for(let i=0;i<r.length;i++){const s=e._cList[r[i]];n=t(s,n.replace(s._tag,c(s)))}}return n}(t,c(t))};e.extend(e.src.component.render,l)}(),function(){const t=e.src.component.diffing,n=e.src.component.render;const r={setState(e,r){!function(e,r){const{state:i}=e,s=Object.keys(r);for(let t=0;t<s.length;t++)i[s[t]]=r[s[t]];const o=n.reRender(e);t.diff(t.stringToHTML(o),e.$()[0])}(e,r)}};e.extend(e.src.component.setstate,r)}(),function(){const{_:t}=e.src.lib;function n(t,e){if(!t._cList)return{parent:t,child:null};const r=Object.keys(t._cList);let i;for(let s=0;s<r.length;s++){if(i=r[s],e===t._cList[i]._tag||e===t._cList[i].id||e===t._cList[i].name)return{parent:t,child:t._cList[i]};const o=n(t._cList[i],e);if(o)return o}return{parent:t,child:null}}const r={getChildren:t=>t._cList?function(t){const e=Object.keys(t._cList),n=[];for(let r=0;r<e.length;r++)n.push({id:t._cList[e[r]].id,name:t._cList[e[r]].name});return n}(t):null,getChild:(e,r)=>r&&t.isString(r)?n(e,r).child:null,removeChild:(e,r)=>!(!r||!t.isString(r))&&function(t,e){const r=n(t,e);if(!r.child)return!1;const i=r.child._tag,s=r.child._tag.replace("<","").replace("/>","").trim();return r.child.$().remove(),Object.getOwnPropertyNames(r.child).forEach(t=>{delete r.child[t]}),r.child.__proto__={},Object.getOwnPropertyNames(r.parent.children[i]).forEach(t=>{delete r.parent.children[i][t]}),r.parent.children[i].__proto__={},delete r.parent._cList[s],delete r.parent.children[i],!0}(e,r)};e.extend(e.src.component.util,r)}(),e.src.rview});