/*! ****************************************************************************
 * RView v1.0.3
 *
 * A companion Reactive View library for building web applications.
 * (you can download it from npm or github repositories)
 * Copyright (c) 2021 Mobilabs <contact@mobilabs.fr> (http://www.mobilabs.fr).
 * Released under the MIT license. You may obtain a copy of the License
 * at: http://www.opensource.org/licenses/mit-license.php).
 * Built from ES6Kadoo v1.0.5.
 * ************************************************************************** */
/*! Generated by Kadoo v1.0.3 */
!function(t,e){"use strict";"function"==typeof define&&define.amd?define([""],e):"object"==typeof exports?module.exports=e(t):t.RView=e(t)}(this,t=>{"use strict";let e={src:{rview:{},component:{main:{},hyperscript:{},diffing:{},config:{},generic:{},$:{},animate:{},add:{},render:{},setstate:{},util:{}},renderer:{main:{}},lib:{_:{}},plugin:{main:{}}},extend:function(t,e){for(var n=Object.keys(e),i=0;i<n.length;i++)t[n[i]]=e[n[i]]}};return function(){const n=e.src.component.main,i=e.src.renderer.main,{_:r}=e.src.lib,s=e.src.component.hyperscript,o=e.src.component.diffing,c=e.src.plugin.main,l=e.src.component.config,a=t.RView,d={_library:{name:"RView",version:"1.0.3"},_setTestMode:()=>[r,n.Component,s,o],noConflict(){return t.RView=a,this},whoami(){return this._library},h:(...t)=>s.format(...t),Component:t=>n.Component(t),render:t=>i.render(t),restore:t=>i.restore(t),remove:t=>i.remove(t),plugin:t=>c.plugin(t),makeid:()=>r.makeid(l.idLength),NAME:"RView",VERSION:"1.0.3"};e.src.rview=d}(),function(){const{_:t}=e.src.lib,n=e.src.component.generic,i=e.src.component.$;e.extend(e.src.component.main,{Component:function(e){let r;const s=function(){return this instanceof s?n.Construct.apply(this,r):(r=arguments,new s)},o=t.assign({},n.methods),c=t.assign(o,{$:i.$});return s.prototype=t.assign(c,e||{}),s.prototype.constructor=s,s}})}(),function(){const t=e.src.component.main,{_:n}=e.src.lib,i=e.src.plugin.main;function r(t){const e={el:"body",children:null,template:"<div></div>"};return t.el&&(!n.isString(t.el)||"#"!==t.el.charAt(0)&&"."!==t.el.charAt(0)?n.isObject(t.el)&&t.el.namespaceURI?e.el=t.el:t.silent||console.log("warning: el must be an id, a class or a node element!"):e.el=t.el),n.isString(t.template)?e.template=function(t){const e=document.createElement("div");if(e.innerHTML=t,e.children.length>1)return`<div>${t}</div>`;const n=e.firstElementChild;if(!n)return"<div></div>";const i=n.tagName.toLocaleLowerCase();return"div"!==i&&"header"!==i&&"footer"!==i?`<div>${t}</div>`:t}(t.template):t.silent||console.log("warning: template must be an XMLString starting with <div or <header or <footer!"),e.children=t.children,e}function s(t){const e=n.isString(t.el)?document.querySelector(t.el):t.el;"body"===t.el?e.innerHTML+=t.template:e.innerHTML=t.template}function o(e){const o=r(e),c=i.get("messenger");if(!e.children&&!e.template)return function(e,r){const{methods:s}=e||{},o=i.get("messenger");if("body"===r.el)return null;const c=n.isString(r.el)?document.querySelector(r.el):r.el,l=c.outerHTML,a=c.getAttribute("id"),d=c.className,u=c.getAttribute("style"),h=t.Component(n.extend(s,{init(){this.state.class=d||"",this.state.style=u||"",this.state.inside=""},render:t=>`\n            <div class="${t.class}" style="${t.style}">${t.inside}</div>\n          `}))(),p=h._renderer(),f=document.createElement("template");f.innerHTML=p;const m=f.content.firstChild;return c.parentNode.replaceChild(m,c),a&&(m.setAttribute("id",a),h.id=a),h._mess=o?o():null,h._initialXMLNode=l,h}(e,o);if(!o.children)return s(o),null;const l=t.Component({render(){return this.name="firstparent",this.children=o.children,o.template}})();return o.template=l._renderer(),s(o),l._mess=c?c():null,function t(e,n){if(e._cList){const i=Object.keys(e._cList);for(let r=0;r<i.length;r++)e._cList[i[r]]._mess=n,t(e._cList[i[r]],n)}}(l,l._mess),function t(e){if(e._cList){const n=Object.keys(e._cList);for(let i=0;i<n.length;i++)e._cList[n[i]].events(),t(e._cList[n[i]])}}(l),l}const c={render:t=>o(t),restore:t=>function(t){if(t&&t._initialXMLNode){const e=document.createElement("template");e.innerHTML=t._initialXMLNode;const n=e.content.firstChild;return t.$()[0].parentNode.replaceChild(n,t.$()[0]),!0}return!1}(t),remove(t){return(e=t).$().remove(),Object.keys(e).forEach(t=>{delete e[t]}),e.__proto__={},!0;var e}};e.extend(e.src.renderer.main,c)}(),function(){const t={extend(t,e){const n=Object.keys(e);for(let i=0;i<n.length;i++)t[n[i]]=e[n[i]];return t},assign(){const t=arguments[0];let e,n,i;for(i=1;i<arguments.length;i++)e=arguments[i],n=Object.keys(e).reduce((t,n)=>(t[n]=Object.getOwnPropertyDescriptor(e,n),t),{});return Object.defineProperties(t,n),t},isString:t=>"[object String]"===Object.prototype.toString.call(t),isNumber:t=>"[object Number]"===Object.prototype.toString.call(t),isObject(t){const e=typeof t;return("function"===e||"object"===e)&&!!t},isLiteralObject:t=>"[object Object]"===Object.prototype.toString.call(t),isFunction:t=>"[object Function]"===Object.prototype.toString.call(t),isArray:t=>"[object Array]"===Object.prototype.toString.call(t),makeid(t){const e=this.isNumber(t)?t:16,n="ABCDEFGHIJKLMNOPQRSTUVWXTZabcdefghijklmnopqrstuvwxyz",i="0123456789"+n;let r=n.charAt(Math.floor(Math.random()*n.length));for(let t=0;t<e-1;t++)r+=i.charAt(Math.floor(Math.random()*i.length));return r}};e.extend(e.src.lib._,t)}(),function(){const{_:t}=e.src.lib;function n(t){const e=Object.keys(t);let n="";for(let i=0;i<e.length;i++)n+=i<e.length-1?`${e[i]}: ${t[e[i]]}; `:`${e[i]}: ${t[e[i]]};`;return n}const i={format(...t){const[e,n,...i]=t;return{nodeName:e,attributes:n,children:i}},render(e,i){const r={};return function(t,e,n){const i=Object.keys(n);for(let r=0;r<i.length;r++)t=t.replace(`</${i[r].toLowerCase()}>`,"").replace(i[r].toLowerCase(),i[r]+" /"),e[`<${i[r]} />`]=n[i[r]];return t}((new XMLSerializer).serializeToString(function e(i,r){const{nodeName:s}=i,{attributes:o}=i,{children:c}=i;let l,a,d,u,h,p;if(t.isString(i))return document.createTextNode(i);switch(typeof s){case"string":for(l=document.createElement(s),a=o?Object.keys(o):[],p=0;p<a.length;p++)d=t.isObject(o[a[p]])?n(o[a[p]]):o[a[p]],l.setAttribute(a[p],d);break;case"function":u=s(),u.render?(h=o&&o.name?o.name:"C"+Math.random().toString(36).substr(2,7),r[h]={fn:s,state:o.state?o.state:null,props:o.props?o.props:null},l=e({nodeName:h,attributes:null,children:[]},r)):l=e(u,r);break;default:throw new Error(`hypserscript._render: nodeName is a ${typeof s} ???`)}for(p=0;p<c.length;p++)l.appendChild(e(c[p],r));return l}(e,r)).replace('xmlns="http://www.w3.org/1999/xhtml"',""),i,r)}};e.extend(e.src.component.hyperscript,i)}(),function(){const t=e.src.component.config;function n(t){return 3===t.nodeType?"text":8===t.nodeType?"comment":t.tagName.toLowerCase()}function i(t){return t.childNodes&&t.childNodes.length>0?null:t.textContent}function r(t,e){const n=t.getAttributeNames(),i=e.getAttributeNames();for(let i=0;i<n.length;i++){const r=n[i],s=e.attributes.getNamedItem(r),o=t.getAttribute(r),c=e.getAttribute(r);s&&c===o||e.setAttribute(r,o)}for(let t=0;t<i.length;t++)-1===n.indexOf(i[t])&&e.removeAttribute(i[t])}const s={stringToHTML:t=>function(t){return(new DOMParser).parseFromString(t,"text/html").body.firstChild}(t),diff(e,s){!function e(s,o){const c=Array.prototype.slice.call(s.childNodes),l=Array.prototype.slice.call(o.childNodes);let a=l.length-c.length;if(a>0)for(;a>0;a--)l[l.length-a].parentNode.removeChild(l[l.length-a]);c.forEach((s,c)=>{if("div"===n(s)&&s.hasAttribute("id")&&s.getAttribute("id").length===t.idLength&&l[c])return;if(!l[c])return void o.appendChild(s.cloneNode(!0));if(n(s)!==n(l[c]))return void l[c].parentNode.replaceChild(s.cloneNode(!0),l[c]);const a=i(s);a&&a!==i(l[c])&&(l[c].textContent=a);const d=n(s);if("text"!==d&&"comment"!==d&&(s.hasAttributes()||l[c].hasAttributes())&&r(s,l[c]),l[c].childNodes.length>0&&s.childNodes.length<1)l[c].innerHTML="";else{if(l[c].childNodes.length<1&&s.childNodes.length>0){const t=document.createDocumentFragment();return e(s,t),void l[c].appendChild(t)}s.childNodes.length>0&&e(s,l[c])}})}(e,s),r(e,s)}};e.extend(e.src.component.diffing,s)}(),function(){const{_:t}=e.src.lib;const n={_db:{messenger:null},plugin(e){return function(e,n){return!(!t.isLiteralObject(n)||!n.messenger||"Messenger"!==n.messenger.NAME)&&(e.messenger=n.messenger,!0)}(this._db,e)},get(e){return t.isString(e)&&this._db[e]?this._db[e]:null}};e.extend(e.src.plugin.main,n)}(),e.extend(e.src.component.config,{idLength:8}),function(){const{_:t}=e.src.lib,n=e.src.component.animate,i=e.src.component.add,r=e.src.component.render,s=e.src.component.hyperscript,o=e.src.component.setstate,c=e.src.component.util,l=e.src.component.config;const a={_init(...e){this._tag=null,this._cList=null,this._mess=null,this.id=t.makeid(l.idLength),this.children=null;const[n,i]=e;return this.state=t.isLiteralObject(n)?n:{},this.props=t.isLiteralObject(i)?i:{},this.name="mynameisnobody",this.init(),this},_renderer(){return r.render(this)},$:null,$animate(...t){return n.animate(this,...t),this},$append(...t){return i.append(this,...t),this},$getChild(t){return c.getChild(this,t)},$getChildren(){return c.getChildren(this)},$getIdAndName(){return{id:this.id,name:this.name}},$hyperscript:(...t)=>s.format(...t),$setState(e){return t.isLiteralObject(e)&&o.setState(this,e),this},$listen(t,e){return this._mess?(this._mess.subscribe(t,e),this):(console.log("$listen: the plugin Messenger is not installed!"),this)},$emit(t,e){return this._mess?(this._mess.publish(t,e),this):(console.log("$emit: the plugin Messenger is not installed!"),this)},init(){return this},events(){return this},render:()=>"<div></div>"};e.extend(e.src.component.generic,{Construct:function(){this._init.apply(this,arguments)},methods:a})}(),e.extend(e.src.component.$,{$:function(t){const e=this.id;let n,i;return t?n=document.querySelector("#"+e).querySelector(t):(n=document.querySelector("#"+e),i=n),{0:n,id:n?n.id:null,_root:i,select:function(t){if("string"==typeof t&&this[0]){const e=this[0].querySelector(t);e&&(this[0]=e)}return this},selectChild:function(t){return"[object Number]"===Object.prototype.toString.call(t)&&(this[0]=this[0].children[t]?this[0].children[t]:this[0]),this},parent:function(){return this._root?this[0]!==this._root&&(this[0]=this[0].parentNode):this[0]=this[0].parentNode,this},firstParent:function(){return this._root&&(this[0]=this._root),this},find:function(t){return this[0].querySelectorAll(t)},tag:function(){return this[0]?this[0].tagName:null},innerHTML:function(){return this[0].innerHTML},outerHTML:function(){return this[0].outerHTML},text:function(){return this[0].textContent},firstChild:function(){return this[0].firstElementChild},children:function(){return this[0].children},childIndex:function(){let t=this[0],e=0;for(;null!==t;)t=t.previousElementSibling,e+=1;return e-1},getBoundingClientRect:function(){return this[0]?this[0].getBoundingClientRect():null},css:function(t){const e="string"==typeof t?t.split("-"):[];let n="";for(let t=0;t<e.length;t++)n+=0===t?e[t]:e[t].charAt(0).toUpperCase()+e[t].slice(1);return this[0].style[n]},getClassList:function(){return this[0].classList},hasClass:function(t){const e=this[0].classList.value.split(" ");return"[object String]"===Object.prototype.toString.call(t)&&-1!==e.indexOf(t)},attr:function(t){return this[0].getAttribute(t)},on:function(t,e){return this[0].addEventListener(t,e),this},off:function(t,e){return this[0].removeEventListener(t,e),this},trigger:function(t){return this[0].dispatchEvent(new Event(t))},remove:function(){return this[0].parentNode.removeChild(this[0]),this}}}}),function(){const{_:t}=e.src.lib;function n(t,e,n,i){return n*(.5-Math.cos(t/i*Math.PI)/2)+e}function i(t){return!("function"!=typeof t||"linear"!==t.name&&"swing"!==t.name&&!t.name.startsWith("easeIn")&&!t.name.startsWith("easeOut"))}function r(e,r,...s){if(!t.isLiteralObject(r))return;const o=function(...e){const n=e[0],r=e[1],s=e[2];let o,c,l,a;switch(o=n||r||s?!n||r||r?n&&r&&!s?2:3:1:0,o){case 0:break;case 1:t.isNumber(n)||"fast"===n||"slow"===n?c=n:t.isString(n)||i(n)?l=n:t.isFunction(n)&&(a=n);break;case 2:t.isNumber(n)||"fast"===n||"slow"===n?(c=n,t.isString(r)||i(r)?l=r:t.isFunction(r)&&(a=r)):(t.isString(n)||i(n))&&(l=n,t.isFunction(r)&&(a=r));break;case 3:(t.isNumber(n)||"fast"===n||"slow"===n)&&(c=n),(t.isString(r)||i(r))&&(l=r),t.isFunction(s)&&(a=s)}return{duration:c,easing:l,callback:a}}(...s),c=t.isNumber(o.duration)&&o.duration>0?o.duration:"fast"===(l=o.duration)?200:"slow"===l?600:400;var l;!function(e,n,i,r,s,o){const c=Object.keys(n),l=void 0!==n.$rpath?n.$rpath.split("."):[],a=c.indexOf("$rpath"),d={},u={};let h,p,f=0;a>-1&&c.splice(a,1);let m=e.state;l.forEach(t=>{m=m[t]}),c.forEach(e=>{h=parseFloat(m[e],10),d[e]={initial:parseFloat(m[e],10),change:parseFloat(n[e],10)-h,suffix:t.isString(n[e])?n[e].replace(/[0-9.]/g,""):""}});const g=setInterval(()=>{for(let t=0;t<c.length;t++)p=i(f,d[c[t]].initial,d[c[t]].change,r),u[c[t]]=p+d[c[t]].suffix;if(a>-1){Object.keys(u).forEach(t=>{m[t]=u[t]}),e.$setState({})}else e.$setState(u);f+=s,f>r&&(clearInterval(g),o&&o())},s)}(e,r,!o.easing||t.isString(o.easing)?n:o.easing,c,10,o.callback?o.callback:null)}const s={animate(t,e,...n){r(t,e,...n)}};e.extend(e.src.component.animate,s)}(),function(){const t=e.src.component.render;function n(e,n,...i){const[r,s,o]=i;!function(t,e,n,i,r,s){const o=i(r,s);o._tag=n,t._cList||(t._cList={}),t.children||(t.children={}),t._cList[o._tag.replace(/[^a-zA-z0-9]/g,"")]=o,t.children[n]={fn:i,state:r,props:s},e?(t._prepend||(t._prepend=[]),t._prepend.push(n)):(t._append||(t._append=[]),t._append.push(n))}(e,n,r,s,o.state,o.props);const c=e.$getChild(r);t.render(c),function t(e,n){if(n&&(e._mess=n,e._cList)){const i=Object.keys(e._cList);for(let r=0;r<i.length;r++)e._cList[i[r]]._mess=n,t(e._cList[i[r]],n)}}(c,e._mess),e.$setState({}),function t(e){if(e.events(),e._cList){const n=Object.keys(e._cList);for(let i=0;i<n.length;i++)e._cList[n[i]].events(),t(e._cList[n[i]])}}(c)}const i={prepend(t,...e){return n(t,!0,...e),this},append(t,...e){return n(t,!1,...e),this}};e.extend(e.src.component.add,i)}(),function(){const{_:t}=e.src.lib,n=e.src.component.hyperscript;function i(t,e){const n=document.createElement("div");if(n.innerHTML=t,n.children.length>1)return[`<div id="${e}">${t}</div>`,!0];const i=n.firstElementChild;if(!i)return[`<div id="${e}"></div>`,!0];const r=i.tagName.toLocaleLowerCase();return"div"!==r&&"header"!==r&&"footer"!==r?[`<div id="${e}">${t}</div>`,!0]:"div"===r?[t.replace(/^\s*<div/,`<div id="${e}"`),!1,"div"]:"header"===r?[t.replace(/^\s*<header/,`<header id="${e}"`),!1,"header"]:[t.replace(/^\s*<footer/,`<footer id="${e}"`),!1,"footer"]}function r(e){let r,s;r=e.render(e.state,e.props),t.isLiteralObject(r)&&t.isString(r.nodeName)&&(e.children={},r=n.render(r,e.children));const[o,c,l]=i(r,e.id);if(s=o,e._tdiv=c?"div":null,e._ttag=l||null,e.children){e.children=function(e){if(!t.isLiteralObject(e))return{};const n={},i=Object.keys(e);let r;for(let s=0;s<i.length;s++)r=i[s],t.isFunction(e[r])?n[r]={fn:e[r],state:null,props:null}:t.isLiteralObject(e[r])&&t.isFunction(e[r].fn)?n[r]={fn:e[r].fn,state:t.isLiteralObject(e[r].state)?e[r].state:null,props:t.isLiteralObject(e[r].props)?e[r].props:null}:(n[r]={fn:null,state:null,props:null},console.log('warning: this component list is invalid. key "c" is missing!'));return n}(e.children),e._cList={};const n=Object.keys(e.children);let i,r;for(let o=0;o<n.length;o++)i=n[o],t.isFunction(e.children[i].fn)?(r=e.children[i].fn(e.children[i].state,e.children[i].props),r._tag=i,s=s.replace(i,r._renderer()),e._cList[i.replace(/[^a-zA-z0-9]/g,"")]=r):console.log(`warning: there is no component associated to this tag: ${i}!`)}return s}function s(t,e){return`${(t=t.trim()).slice(0,t.indexOf(">")+1)}${e}${t.slice(t.indexOf(">")+1)}`}function o(t,e){return`${(t=t.trim()).slice(0,t.lastIndexOf("</"))}${e}${t.slice(t.lastIndexOf("</"))}`}function c(e){let r=e.render(e.state,e.props);if(t.isLiteralObject(r)&&t.isString(r.nodeName)&&(r=n.render(r,{})),[r]=i(r,e.id),t.isArray(e._prepend)){for(let t=0;t<e._prepend.length;t++)r=s(r,e._prepend[t]);return r}if(t.isArray(e._append)){for(let t=0;t<e._append.length;t++)r=o(r,e._append[t]);return r}return r}const l={render:t=>r(t),reRender:t=>function t(e,n){if(e._cList){const i=Object.keys(e._cList);for(let r=0;r<i.length;r++){const s=e._cList[i[r]];n=t(s,n.replace(s._tag,c(s)))}}return n}(t,c(t))};e.extend(e.src.component.render,l)}(),function(){const t=e.src.component.diffing,n=e.src.component.render;const i={setState(e,i){!function(e,i){const{state:r}=e,s=Object.keys(i);for(let t=0;t<s.length;t++)r[s[t]]=i[s[t]];const o=n.reRender(e);t.diff(t.stringToHTML(o),e.$()[0])}(e,i)}};e.extend(e.src.component.setstate,i)}(),function(){const{_:t}=e.src.lib;const n={getChildren:t=>t._cList?function(t){const e=Object.keys(t._cList),n=[];for(let i=0;i<e.length;i++)n.push({id:t._cList[e[i]].id,name:t._cList[e[i]].name});return n}(t):null,getChild:(e,n)=>n&&t.isString(n)?function t(e,n){if(!e._cList)return null;const i=Object.keys(e._cList);let r;for(let s=0;s<i.length;s++){if(r=i[s],n===e._cList[r]._tag||n===e._cList[r].id||n===e._cList[r].name)return e._cList[r];const o=t(e._cList[r],n);if(o)return o}return null}(e,n):null};e.extend(e.src.component.util,n)}(),e.src.rview});