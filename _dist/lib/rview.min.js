/*! ****************************************************************************
 * RView v1.0.6
 *
 * A companion Reactive View library for building web applications.
 * (you can download it from npm or github repositories)
 * Copyright (c) 2021 Mobilabs <contact@mobilabs.fr> (http://www.mobilabs.fr).
 * Released under the MIT license. You may obtain a copy of the License
 * at: http://www.opensource.org/licenses/mit-license.php).
 * Built from ES6Kadoo v1.0.8.
 * ************************************************************************** */
/*! Generated by Kadoo v1.0.4 */
!function(e,t){"use strict";"function"==typeof define&&define.amd?define([""],t):"object"==typeof exports?module.exports=t(e):e.RView=t(e)}(this,e=>{"use strict";let t={src:{rview:{},component:{main:{},hyperscript:{},diffing:{},config:{},generic:{},$:{},animate:{},add:{},render:{},setstate:{},util:{}},renderer:{main:{}},lib:{_:{}},plugin:{main:{}}},extend:function(e,t){for(var n=Object.keys(t),r=0;r<n.length;r++)e[n[r]]=t[n[r]]}};return function(){const n=t.src.component.main,r=t.src.renderer.main,{_:i}=t.src.lib,s=t.src.component.hyperscript,o=t.src.component.diffing,c=t.src.plugin.main,l=t.src.component.config,a=e.RView,d={_library:{name:"RView",version:"1.0.6"},_setTestMode:()=>[i,n.Component,s,o],noConflict(){return e.RView=a,this},whoami(){return this._library},h:(...e)=>s.format(...e),Component:e=>n.Component(e),render:e=>r.render(e),restore:e=>r.restore(e),remove:e=>r.remove(e),plugin:e=>c.plugin(e),makeid:()=>i.makeid(l.idLength),NAME:"RView",VERSION:"1.0.6"};t.src.rview=d}(),function(){const{_:e}=t.src.lib,n=t.src.component.generic,r=t.src.component.$;t.extend(t.src.component.main,{Component:function(t){let i;const s=function(){return this instanceof s?n.Construct.apply(this,i):(i=arguments,new s)},o=e.assign({},n.methods),c=e.assign(o,{$:r.$});return s.prototype=e.assign(c,t||{}),s.prototype.constructor=s,s}})}(),function(){const e=t.src.component.main,{_:n}=t.src.lib,r=t.src.plugin.main;function i(e){const t={el:"body",children:null,template:"<div></div>"};return e.el&&(!n.isString(e.el)||"#"!==e.el.charAt(0)&&"."!==e.el.charAt(0)?n.isObject(e.el)&&e.el.namespaceURI?t.el=e.el:e.silent||console.log("warning: el must be an id, a class or a node element!"):t.el=e.el),n.isString(e.template)?t.template=function(e){const t=document.createElement("div");if(t.innerHTML=e,t.children.length>1)return`<div>${e}</div>`;const n=t.firstElementChild;if(!n)return"<div></div>";const r=n.tagName.toLocaleLowerCase();return"div"!==r&&"header"!==r&&"footer"!==r?`<div>${e}</div>`:e}(e.template):e.silent||console.log("warning: template must be an XMLString starting with <div or <header or <footer!"),t.children=e.children,t}function s(e){const t=n.isString(e.el)?document.querySelector(e.el):e.el;"body"===e.el?t.innerHTML+=e.template:t.innerHTML=e.template}function o(t){const o=i(t),c=r.get("messenger");if(!t.children&&!t.template)return function(t,i){const{methods:s}=t||{},o=r.get("messenger");if("body"===i.el)return null;const c=n.isString(i.el)?document.querySelector(i.el):i.el,l=c.outerHTML,a=c.getAttribute("id"),d=c.className,u=c.getAttribute("style"),h=e.Component(n.extend(s,{init(){this.state.class=d||"",this.state.style=u||"",this.state.inside=""},render:e=>`\n            <div class="${e.class}" style="${e.style}">${e.inside}</div>\n          `}))(),p=h._renderer(),f=document.createElement("template");f.innerHTML=p;const m=f.content.firstChild;return c.parentNode.replaceChild(m,c),a&&(m.setAttribute("id",a),h.id=a),h._mess=o?o():null,h._initialXMLNode=l,h}(t,o);if(!o.children)return s(o),null;const l=e.Component({render(){return this.name="firstparent",this.children=o.children,o.template}})();return o.template=l._renderer(),s(o),l._mess=c?c():null,function e(t,n){if(t._cList){const r=Object.keys(t._cList);for(let i=0;i<r.length;i++)t._cList[r[i]]._mess=n,e(t._cList[r[i]],n)}}(l,l._mess),function e(t){if(t._cList){const n=Object.keys(t._cList);for(let r=0;r<n.length;r++)t._cList[n[r]].events(),e(t._cList[n[r]])}}(l),l}const c={render:e=>o(e),restore:e=>function(e){if(e&&e._initialXMLNode){const t=document.createElement("template");t.innerHTML=e._initialXMLNode;const n=t.content.firstChild;return e.$()[0].parentNode.replaceChild(n,e.$()[0]),!0}return!1}(e),remove(e){return(t=e).$().remove(),Object.keys(t).forEach(e=>{delete t[e]}),t.__proto__={},!0;var t}};t.extend(t.src.renderer.main,c)}(),function(){const e={extend(e,t){const n=Object.keys(t);for(let r=0;r<n.length;r++)e[n[r]]=t[n[r]];return e},assign(){const e=arguments[0];let t,n,r;for(r=1;r<arguments.length;r++)t=arguments[r],n=Object.keys(t).reduce((e,n)=>(e[n]=Object.getOwnPropertyDescriptor(t,n),e),{});return Object.defineProperties(e,n),e},isString:e=>"[object String]"===Object.prototype.toString.call(e),isNumber:e=>"[object Number]"===Object.prototype.toString.call(e),isObject(e){const t=typeof e;return("function"===t||"object"===t)&&!!e},isLiteralObject:e=>"[object Object]"===Object.prototype.toString.call(e),isFunction:e=>"[object Function]"===Object.prototype.toString.call(e),isArray:e=>"[object Array]"===Object.prototype.toString.call(e),makeid(e){const t=this.isNumber(e)?e:16,n="ABCDEFGHIJKLMNOPQRSTUVWXTZabcdefghijklmnopqrstuvwxyz",r="0123456789"+n;let i=n.charAt(Math.floor(Math.random()*n.length));for(let e=0;e<t-1;e++)i+=r.charAt(Math.floor(Math.random()*r.length));return i}};t.extend(t.src.lib._,e)}(),function(){const{_:e}=t.src.lib;function n(e){const t=Object.keys(e);let n="";for(let r=0;r<t.length;r++)n+=r<t.length-1?`${t[r]}: ${e[t[r]]}; `:`${t[r]}: ${e[t[r]]};`;return n}const r={format(...e){const[t,n,...r]=e;return{nodeName:t,attributes:n,children:r}},render(t,r){const i={};return function(e,t,n){const r=Object.keys(n);for(let i=0;i<r.length;i++)e=e.replace(`</${r[i].toLowerCase()}>`,"").replace(r[i].toLowerCase(),r[i]+" /"),t[`<${r[i]} />`]=n[r[i]];return e}((new XMLSerializer).serializeToString(function t(r,i){const{nodeName:s}=r,{attributes:o}=r,{children:c}=r;let l,a,d,u,h,p;if(e.isString(r))return document.createTextNode(r);switch(typeof s){case"string":for(l=document.createElement(s),a=o?Object.keys(o):[],p=0;p<a.length;p++)d=e.isObject(o[a[p]])?n(o[a[p]]):o[a[p]],l.setAttribute(a[p],d);break;case"function":u=s(),u.render?(h=o&&o.name?o.name:"C"+Math.random().toString(36).substr(2,7),i[h]={fn:s,state:o.state?o.state:null,props:o.props?o.props:null},l=t({nodeName:h,attributes:null,children:[]},i)):l=t(u,i);break;default:throw new Error(`hypserscript._render: nodeName is a ${typeof s} ???`)}for(p=0;p<c.length;p++)l.appendChild(t(c[p],i));return l}(t,i)).replace('xmlns="http://www.w3.org/1999/xhtml"',""),r,i)}};t.extend(t.src.component.hyperscript,r)}(),function(){const e=t.src.component.config;function n(e){return 3===e.nodeType?"text":8===e.nodeType?"comment":e.tagName.toLowerCase()}function r(e){return e.childNodes&&e.childNodes.length>0?null:e.textContent}function i(e,t){const n=e.getAttributeNames(),r=t.getAttributeNames();for(let r=0;r<n.length;r++){const i=n[r],s=t.attributes.getNamedItem(i),o=e.getAttribute(i),c=t.getAttribute(i);s&&c===o||t.setAttribute(i,o)}for(let e=0;e<r.length;e++)-1===n.indexOf(r[e])&&t.removeAttribute(r[e])}const s={stringToHTML:e=>function(e){return(new DOMParser).parseFromString(e,"text/html").body.firstChild}(e),diff(t,s){!function t(s,o){const c=Array.prototype.slice.call(s.childNodes),l=Array.prototype.slice.call(o.childNodes);let a=l.length-c.length;if(a>0)for(;a>0;a--)l[l.length-a].parentNode.removeChild(l[l.length-a]);c.forEach((s,c)=>{if("div"===n(s)&&s.hasAttribute("id")&&s.getAttribute("id").length===e.idLength&&l[c])return;if(!l[c])return void o.appendChild(s.cloneNode(!0));if(n(s)!==n(l[c]))return void l[c].parentNode.replaceChild(s.cloneNode(!0),l[c]);const a=r(s);a&&a!==r(l[c])&&(l[c].textContent=a);const d=n(s);if("text"!==d&&"comment"!==d&&(s.hasAttributes()||l[c].hasAttributes())&&i(s,l[c]),l[c].childNodes.length>0&&s.childNodes.length<1)l[c].innerHTML="";else{if(l[c].childNodes.length<1&&s.childNodes.length>0){const e=document.createDocumentFragment();return t(s,e),void l[c].appendChild(e)}s.childNodes.length>0&&t(s,l[c])}})}(t,s),i(t,s)}};t.extend(t.src.component.diffing,s)}(),function(){const{_:e}=t.src.lib;const n={_db:{messenger:null},plugin(t){return function(t,n){return!(!e.isLiteralObject(n)||!n.messenger||"Messenger"!==n.messenger.NAME)&&(t.messenger=n.messenger,!0)}(this._db,t)},get(t){return e.isString(t)&&this._db[t]?this._db[t]:null}};t.extend(t.src.plugin.main,n)}(),t.extend(t.src.component.config,{idLength:8}),function(){const{_:e}=t.src.lib,n=t.src.component.animate,r=t.src.component.add,i=t.src.component.render,s=t.src.component.hyperscript,o=t.src.component.setstate,c=t.src.component.util,l=t.src.component.config;const a={_init(...t){this._tag=null,this._cList=null,this._mess=null,this.id=e.makeid(l.idLength),this.children=null;const[n,r]=t;return this.state=e.isLiteralObject(n)?n:{},this.props=e.isLiteralObject(r)?r:{},this.name="mynameisnobody",this.init(),this},_renderer(){return i.render(this)},_render(...t){const n=this.render(...t);return e.isString(n)?n.trim():n},$:null,$animate(...e){return n.animate(this,...e),this},$append(...e){return r.append(this,...e),this},$getChild(e){return c.getChild(this,e)},$removeChild(e){return c.removeChild(this,e)},$getChildren(){return c.getChildren(this)},$getIdAndName(){return{id:this.id,name:this.name}},$hyperscript:(...e)=>s.format(...e),$setState(t){return e.isLiteralObject(t)&&o.setState(this,t),this},$listen(e,t){return this._mess?(this._mess.subscribe(e,t),this):(console.log("$listen: the plugin Messenger is not installed!"),this)},$emit(e,t){return this._mess?(this._mess.publish(e,t),this):(console.log("$emit: the plugin Messenger is not installed!"),this)},init(){return this},events(){return this},render:()=>"<div></div>"};t.extend(t.src.component.generic,{Construct:function(){this._init.apply(this,arguments)},methods:a})}(),t.extend(t.src.component.$,{$:function(e){const t=this.id;let n,r;return e?n=document.querySelector("#"+t).querySelector(e):(n=document.querySelector("#"+t),r=n),{0:n,id:n?n.id:null,_root:r,select:function(e){if("string"==typeof e&&this[0]){const t=this[0].querySelector(e);t&&(this[0]=t)}return this},selectChild:function(e){return"[object Number]"===Object.prototype.toString.call(e)&&(this[0]=this[0].children[e]?this[0].children[e]:this[0]),this},parent:function(){return this._root?this[0]!==this._root&&(this[0]=this[0].parentNode):this[0]=this[0].parentNode,this},firstParent:function(){return this._root&&(this[0]=this._root),this},find:function(e){return this[0].querySelectorAll(e)},tag:function(){return this[0]?this[0].tagName:null},innerHTML:function(){return this[0].innerHTML},outerHTML:function(){return this[0].outerHTML},text:function(){return this[0].textContent},firstChild:function(){return this[0].firstElementChild},children:function(){return this[0].children},childIndex:function(){let e=this[0],t=0;for(;null!==e;)e=e.previousElementSibling,t+=1;return t-1},getBoundingClientRect:function(){return this[0]?this[0].getBoundingClientRect():null},css:function(e){const t="string"==typeof e?e.split("-"):[];let n="";for(let e=0;e<t.length;e++)n+=0===e?t[e]:t[e].charAt(0).toUpperCase()+t[e].slice(1);return this[0].style[n]},getClassList:function(){return this[0].classList},hasClass:function(e){const t=this[0].classList.value.split(" ");return"[object String]"===Object.prototype.toString.call(e)&&-1!==t.indexOf(e)},attr:function(e){return this[0].getAttribute(e)},on:function(e,t){return this[0].addEventListener(e,t),this},off:function(e,t){return this[0].removeEventListener(e,t),this},trigger:function(e){return this[0].dispatchEvent(new Event(e))},remove:function(){return this[0].parentNode.removeChild(this[0]),this}}}}),function(){const{_:e}=t.src.lib;function n(e,t,n,r){return n*(.5-Math.cos(e/r*Math.PI)/2)+t}function r(e){return!("function"!=typeof e||"linear"!==e.name&&"swing"!==e.name&&!e.name.startsWith("easeIn")&&!e.name.startsWith("easeOut"))}function i(t,i,...s){if(!e.isLiteralObject(i))return;const o=function(...t){const n=t[0],i=t[1],s=t[2];let o,c,l,a;switch(o=n||i||s?!n||i||i?n&&i&&!s?2:3:1:0,o){case 0:break;case 1:e.isNumber(n)||"fast"===n||"slow"===n?c=n:e.isString(n)||r(n)?l=n:e.isFunction(n)&&(a=n);break;case 2:e.isNumber(n)||"fast"===n||"slow"===n?(c=n,e.isString(i)||r(i)?l=i:e.isFunction(i)&&(a=i)):(e.isString(n)||r(n))&&(l=n,e.isFunction(i)&&(a=i));break;case 3:(e.isNumber(n)||"fast"===n||"slow"===n)&&(c=n),(e.isString(i)||r(i))&&(l=i),e.isFunction(s)&&(a=s)}return{duration:c,easing:l,callback:a}}(...s),c=e.isNumber(o.duration)&&o.duration>0?o.duration:"fast"===(l=o.duration)?200:"slow"===l?600:400;var l;!function(t,n,r,i,s,o){const c=Object.keys(n),l=void 0!==n.$rpath?n.$rpath.split("."):[],a=c.indexOf("$rpath"),d={},u={};let h,p,f=0;a>-1&&c.splice(a,1);let m=t.state;l.forEach(e=>{m=m[e]}),c.forEach(t=>{h=parseFloat(m[t],10),d[t]={initial:parseFloat(m[t],10),change:parseFloat(n[t],10)-h,suffix:e.isString(n[t])?n[t].replace(/[0-9.]/g,""):""}});const g=setInterval(()=>{for(let e=0;e<c.length;e++)p=r(f,d[c[e]].initial,d[c[e]].change,i),u[c[e]]=p+d[c[e]].suffix;if(a>-1){Object.keys(u).forEach(e=>{m[e]=u[e]}),t.$setState({})}else t.$setState(u);f+=s,f>i&&(clearInterval(g),o&&o())},s)}(t,i,!o.easing||e.isString(o.easing)?n:o.easing,c,10,o.callback?o.callback:null)}const s={animate(e,t,...n){i(e,t,...n)}};t.extend(t.src.component.animate,s)}(),function(){const e=t.src.component.render;function n(t,n,...r){const[i,s,o]=r,c=o||{};!function(e,t,n,r,i,s){const o=r(i,s);o._tag=n,e._cList||(e._cList={}),e.children||(e.children={}),e._cList[o._tag.replace(/[^a-zA-z0-9]/g,"")]=o,e.children[n]={fn:r,state:i,props:s},t?(e._prepend||(e._prepend=[]),e._prepend.push(n)):(e._append||(e._append=[]),e._append.push(n))}(t,n,i,s,c.state,c.props);const l=t.$getChild(i);e.render(l),function e(t,n){if(n&&(t._mess=n,t._cList)){const r=Object.keys(t._cList);for(let i=0;i<r.length;i++)t._cList[r[i]]._mess=n,e(t._cList[r[i]],n)}}(l,t._mess),t.$setState({}),l.events(),function e(t){if(t._cList){const n=Object.keys(t._cList);for(let r=0;r<n.length;r++)t._cList[n[r]].events(),e(t._cList[n[r]])}}(l)}const r={prepend(e,...t){return n(e,!0,...t),this},append(e,...t){return n(e,!1,...t),this}};t.extend(t.src.component.add,r)}(),function(){const{_:e}=t.src.lib,n=t.src.component.hyperscript;function r(e,t){const n=document.createElement("div");if(n.innerHTML=e,n.children.length>1)return[`<div id="${t}">${e}</div>`,!0];const r=n.firstElementChild;if(!r)return[`<div id="${t}"></div>`,!0];const i=r.tagName.toLocaleLowerCase();return"div"!==i&&"header"!==i&&"footer"!==i?[`<div id="${t}">${e}</div>`,!0]:"div"===i?[e.replace(/^\s*<div/,`<div id="${t}"`),!1,"div"]:"header"===i?[e.replace(/^\s*<header/,`<header id="${t}"`),!1,"header"]:[e.replace(/^\s*<footer/,`<footer id="${t}"`),!1,"footer"]}function i(t){let i,s;i=t._render(t.state,t.props),e.isLiteralObject(i)&&e.isString(i.nodeName)&&(t.children={},i=n.render(i,t.children));const[o,c,l]=r(i,t.id);if(s=o,t._tdiv=c?"div":null,t._ttag=l||null,t.children){t.children=function(t){if(!e.isLiteralObject(t))return{};const n={},r=Object.keys(t);let i;for(let s=0;s<r.length;s++)i=r[s],e.isFunction(t[i])?n[i]={fn:t[i],state:null,props:null}:e.isLiteralObject(t[i])&&e.isFunction(t[i].fn)?n[i]={fn:t[i].fn,state:e.isLiteralObject(t[i].state)?t[i].state:null,props:e.isLiteralObject(t[i].props)?t[i].props:null}:(n[i]={fn:null,state:null,props:null},console.log('warning: this component list is invalid. key "c" is missing!'));return n}(t.children),t._cList={};const n=Object.keys(t.children);let r,i;for(let o=0;o<n.length;o++)r=n[o],e.isFunction(t.children[r].fn)?(i=t.children[r].fn(t.children[r].state,t.children[r].props),i._tag=r,s=s.replace(r,i._renderer()),t._cList[r.replace(/[^a-zA-z0-9]/g,"")]=i):console.log(`warning: there is no component associated to this tag: ${r}!`)}return s}function s(e,t){return`${(e=e.trim()).slice(0,e.indexOf(">")+1)}${t}${e.slice(e.indexOf(">")+1)}`}function o(e,t){return`${(e=e.trim()).slice(0,e.lastIndexOf("</"))}${t}${e.slice(e.lastIndexOf("</"))}`}function c(t){let i=t._render(t.state,t.props);if(e.isLiteralObject(i)&&e.isString(i.nodeName)&&(i=n.render(i,{})),[i]=r(i,t.id),e.isArray(t._prepend)){for(let e=0;e<t._prepend.length;e++)i=s(i,t._prepend[e]);return i}if(e.isArray(t._append)){for(let e=0;e<t._append.length;e++)i=o(i,t._append[e]);return i}return i}const l={render:e=>i(e),reRender:e=>function e(t,n){if(t._cList){const r=Object.keys(t._cList);for(let i=0;i<r.length;i++){const s=t._cList[r[i]];n=e(s,n.replace(s._tag,c(s)))}}return n}(e,c(e))};t.extend(t.src.component.render,l)}(),function(){const e=t.src.component.diffing,n=t.src.component.render;const r={setState(t,r){!function(t,r){const{state:i}=t,s=Object.keys(r);for(let e=0;e<s.length;e++)i[s[e]]=r[s[e]];const o=n.reRender(t);e.diff(e.stringToHTML(o),t.$()[0])}(t,r)}};t.extend(t.src.component.setstate,r)}(),function(){const{_:e}=t.src.lib;function n(e,t){if(!e._cList)return{parent:e,child:null};const r=Object.keys(e._cList);let i;for(let s=0;s<r.length;s++){if(i=r[s],t===e._cList[i]._tag||t===e._cList[i].id||t===e._cList[i].name)return{parent:e,child:e._cList[i]};const o=n(e._cList[i],t);if(o.child)return o}return{parent:e,child:null}}const r={getChildren:e=>e._cList?function(e){const t=Object.keys(e._cList),n=[];for(let r=0;r<t.length;r++)n.push({id:e._cList[t[r]].id,name:e._cList[t[r]].name});return n}(e):null,getChild:(t,r)=>r&&e.isString(r)?n(t,r).child:null,removeChild:(t,r)=>!(!r||!e.isString(r))&&function(e,t){const r=n(e,t);if(!r.child)return!1;const i=r.child._tag,s=r.child._tag.replace("<","").replace("/>","").trim();return r.child.$().remove(),Object.getOwnPropertyNames(r.child).forEach(e=>{delete r.child[e]}),r.child.__proto__={},Object.getOwnPropertyNames(r.parent.children[i]).forEach(e=>{delete r.parent.children[i][e]}),r.parent.children[i].__proto__={},delete r.parent._cList[s],delete r.parent.children[i],r.parent._append&&(r.parent._append=r.parent._append.filter(e=>e!==i)),r.parent._prepend&&(r.parent._prepend=r.parent._prepend.filter(e=>e!==i)),!0}(t,r)};t.extend(t.src.component.util,r)}(),t.src.rview});